#!/bin/bash

function show_usage() {
    echo "Usage: $0 [ server_name ]" 1>&2;
}

function show_help() {
    echo "Usage: $0 [ server_name ]" 1>&2;
}


if [ $# -lt 1 ]
then
    show_usage
    exit 1
fi

unmount=false

while [[ $# -gt 0 ]]; do
    opt="$1"
    shift;
    case ${opt} in
        "bluecrystal2" | "bc2")
            mountpoint="${HOME}/remoteservers/bluecrystal2/"
            user='mp15688'
            host='bluecrystalp2.bris.ac.uk'
            remote_dir=''
            ;;
        "bluecrystal3" | "bc3")
            mountpoint="${HOME}/remoteservers/bluecrystal3/"
            user='mp15688'
            host='bluecrystalp3.bris.ac.uk'
            remote_dir=''
            ;;
        "bluecrystal4" | "bc4")
            mountpoint="${HOME}/remoteservers/bluecrystal4/"
            user='mp15688'
            host='bluecrystalp4.bris.ac.uk'
            remote_dir=''
            ;;
        "perellonieto")
            mountpoint="${HOME}/remoteservers/perellonieto/"
            user='maikel'
            host='perellonieto.com'
            remote_dir=''
            ;;
        "-u"|"--unmount")
            unmount=true
            ;;
        *)
            show_help
            exit 0
            ;;
    esac
done

if [ "${unmount}" = false ] ; then
    echo "Creating mountpoint ${mountpoint}"
    mkdir -p ${mountpoint}

    echo "Mounting to remote folder ${user}@${host}:${remote_dir}"
    sshfs "${user}@${host}:${remote_dir}" ${mountpoint}
else
    echo "Unmounting folder ${mountpoint}"
    fusermount -u ${mountpoint}
fi

